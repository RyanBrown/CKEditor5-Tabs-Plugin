<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Enhanced Vanilla JS PrimeNG-like Radio Button</title>
</head>

<body>

  <!-- Example Usage -->
  <form id="radioForm">
    <cka-radio-button name="group1" value="option1" label="Option 1" checked></cka-radio-button>
    <cka-radio-button name="group1" value="option2" label="Option 2"></cka-radio-button>
    <cka-radio-button name="group1" value="option3" label="Option 3" disabled></cka-radio-button>
  </form>

  <script>
    class CKAlightRadioButton extends HTMLElement {
      constructor() {
        super();
        this.attachShadow({ mode: 'open' });

        // Create the template
        const wrapper = document.createElement('label');
        wrapper.classList.add('cka-radio-button');

        // Handle 'disabled' attribute
        if (this.hasAttribute('disabled')) {
          wrapper.classList.add('disabled');
        }

        // Create the radio input
        this.radioInput = document.createElement('input');
        this.radioInput.type = 'radio';
        this.radioInput.name = this.getAttribute('name') || '';
        this.radioInput.value = this.getAttribute('value') || '';
        this.radioInput.id = `radio-${Math.random().toString(36).substr(2, 9)}`; // Unique ID for accessibility

        // Handle 'checked' attribute
        if (this.hasAttribute('checked')) {
          this.radioInput.checked = true;
        }

        // Handle 'disabled' attribute
        if (this.hasAttribute('disabled')) {
          this.radioInput.disabled = true;
        }

        // Create the custom radio icon
        const radioIcon = document.createElement('span');
        radioIcon.classList.add('cka-radio-icon');

        // Create the label text
        const labelText = document.createElement('span');
        labelText.classList.add('label-text');
        labelText.textContent = this.getAttribute('label') || '';

        // Associate label with input for accessibility
        wrapper.htmlFor = this.radioInput.id;

        // Append elements
        wrapper.appendChild(this.radioInput);
        wrapper.appendChild(radioIcon);
        wrapper.appendChild(labelText);
        this.shadowRoot.appendChild(wrapper);

        // Event Listener
        this.radioInput.addEventListener('change', (e) => {
          this.dispatchEvent(new Event('change', { bubbles: true }));
        });

        // Define and attach styles within the Shadow DOM
        const style = document.createElement('style');
        style.textContent = `
          /* Enhanced PrimeNG-like Radio Button Styles */
          :host {
            display: inline-block;
            margin: 0.5rem 0;
          }

          .cka-radio-button {
            display: flex;
            align-items: center;
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-left: 2rem;
            font-size: 1rem;
            color: #333;
            transition: color 0.3s;
          }

          .cka-radio-button input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
          }

          .cka-radio-button .cka-radio-icon {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 1.2rem;
            width: 1.2rem;
            background-color: #fff;
            border: 2px solid #007ad9;
            border-radius: 50%;
            box-sizing: border-box;
            transition: border-color 0.3s, background-color 0.3s;
          }

          /* Outer Circle Animation */
          .cka-radio-button .cka-radio-icon::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 0.6rem;
            height: 0.6rem;
            background-color: #007ad9;
            border-radius: 50%;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
            opacity: 0;
          }

          /* Checked State */
          .cka-radio-button input[type="radio"]:checked + .cka-radio-icon::after {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
          }

          /* Hover Effects */
          .cka-radio-button:hover .cka-radio-icon {
            border-color: #005bb5;
          }

          .cka-radio-button:hover .label-text {
            color: #005bb5;
          }

          /* Focus Styles for Accessibility */
          .cka-radio-button input[type="radio"]:focus + .cka-radio-icon {
            box-shadow: 0 0 0 3px rgba(0, 122, 217, 0.3);
          }

          /* Disabled State */
          .cka-radio-button.disabled {
            cursor: not-allowed;
            color: #a8a8a8;
          }

          .cka-radio-button.disabled .cka-radio-icon {
            border-color: #a8a8a8;
            background-color: #f5f5f5;
          }

          .cka-radio-button.disabled input[type="radio"]:checked + .cka-radio-icon::after {
            background-color: #a8a8a8;
          }

          /* Transition for Label Color */
          .cka-radio-button .label-text {
            transition: color 0.3s;
          }
        `;
        this.shadowRoot.appendChild(style);
      }

      static get observedAttributes() {
        return ['name', 'value', 'label', 'checked', 'disabled'];
      }

      attributeChangedCallback(name, oldValue, newValue) {
        switch (name) {
          case 'name':
            this.radioInput.name = newValue;
            break;
          case 'value':
            this.radioInput.value = newValue;
            break;
          case 'label':
            this.shadowRoot.querySelector('.label-text').textContent = newValue;
            break;
          case 'checked':
            this.radioInput.checked = newValue !== null;
            break;
          case 'disabled':
            if (newValue !== null) {
              this.radioInput.disabled = true;
              this.shadowRoot.querySelector('.cka-radio-button').classList.add('disabled');
            } else {
              this.radioInput.disabled = false;
              this.shadowRoot.querySelector('.cka-radio-button').classList.remove('disabled');
            }
            break;
        }
      }

      // Getter and Setter for checked property
      get checked() {
        return this.radioInput.checked;
      }

      set checked(val) {
        this.radioInput.checked = val;
        if (val) {
          this.setAttribute('checked', '');
        } else {
          this.removeAttribute('checked');
        }
      }

      // Getter and Setter for disabled property
      get disabled() {
        return this.radioInput.disabled;
      }

      set disabled(val) {
        if (val) {
          this.setAttribute('disabled', '');
        } else {
          this.removeAttribute('disabled');
        }
      }
    }

    // Define the custom element with the new name
    window.customElements.define('cka-radio-button', CKAlightRadioButton);

    // Example: Handling change events
    document.getElementById('radioForm').addEventListener('change', (e) => {
      const selected = document.querySelector('cka-radio-button[name="group1"] input[type="radio"]:checked');
      if (selected) {
        console.log('Selected Value:', selected.value);
      }
    });
  </script>
</body>

</html>